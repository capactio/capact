name: Master build

on: 
  push:
    paths:
    - '**.yaml'
    branches: 
    - 'devops-*'


jobs:
  entry-tests:
    name: Git crypt tests
    runs-on: ubuntu-latest
      
    steps:    
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Setup env
        run: |
          . ./env_setup.sh
          sudo apt-get update -y && sudo apt-get install -y git-crypt
          printf "$GIT_CRYPT_KEY" | base64 --decode > ./private.key
          cat ./private.key
          git-crypt unlock ./private.key
          cat data/qqq.txt
        env:
          GIT_CRYPT_KEY: ${{ secrets.GIT_CRYPT_KEY }}
